PRE-REQUISITE:
ZATS_00_DE_ID - point to domain below
ZATS_00_DO_ID - 32 char

@EndUserText.label : 'Business Partners'
@AbapCatalog.enhancementCategory : #NOT_EXTENSIBLE
@AbapCatalog.tableCategory : #TRANSPARENT
@AbapCatalog.deliveryClass : #A
@AbapCatalog.dataMaintenance : #LIMITED
define table zats_00_bp {
  key client   : abap.clnt not null;
  key bp_id    : zats_00_de_id not null;
  bp_role      : zats_00_de_role;
  company_name : abap.string(256);
  street       : abap.string(256);
  city         : abap.char(80);
  country      : land1;
  region       : abap.char(3);

}

@EndUserText.label : 'Products'
@AbapCatalog.enhancementCategory : #NOT_EXTENSIBLE
@AbapCatalog.tableCategory : #TRANSPARENT
@AbapCatalog.deliveryClass : #A
@AbapCatalog.dataMaintenance : #LIMITED
define table zats_00_product {
  key client     : abap.clnt not null;
  key product_id : zats_00_de_id not null;
  name           : abap.char(100);
  category       : abap.char(80);
  @Semantics.amount.currencyCode : 'zats_00_product.currency'
  price          : abap.curr(10,2);
  currency       : abap.cuky;
  discount       : abap.int1;

}

@EndUserText.label : 'Sales Orders'
@AbapCatalog.enhancementCategory : #NOT_EXTENSIBLE
@AbapCatalog.tableCategory : #TRANSPARENT
@AbapCatalog.deliveryClass : #A
@AbapCatalog.dataMaintenance : #LIMITED
define table zats_00_so {
  key client   : abap.clnt not null;
  key order_id : zats_00_de_id not null;
  order_no     : abap.int4;
  @AbapCatalog.foreignKey.screenCheck : false
  buyer        : zats_00_de_id not null
    with foreign key [0..*,1] zats_00_bp
      where bp_id = zats_00_so.buyer;
  @Semantics.amount.currencyCode : 'zats_00_so.currency'
  gross_amount : abap.curr(10,2);
  currency     : abap.cuky;
  include zats_00_admin_data;

}


@EndUserText.label : 'Sales Orders Items'
@AbapCatalog.enhancementCategory : #NOT_EXTENSIBLE
@AbapCatalog.tableCategory : #TRANSPARENT
@AbapCatalog.deliveryClass : #A
@AbapCatalog.dataMaintenance : #LIMITED
define table zats_00_so_i {
  key client  : abap.clnt not null;
  key item_id : zats_00_de_id not null;
  order_id    : zats_00_de_id not null;
  @AbapCatalog.foreignKey.screenCheck : false
  product     : zats_00_de_id not null
    with foreign key [0..*,1] zats_00_product
      where product_id = zats_00_so_i.product;
  @Semantics.quantity.unitOfMeasure : 'zats_00_so_i.uom'
  qty         : abap.quan(2,1);
  uom         : abap.unit(2);
  @Semantics.amount.currencyCode : 'zats_00_so_i.currency'
  amount      : abap.curr(10,2);
  currency    : abap.cuky;
  include zats_00_admin_data;

}



CLASS zats_00_fill_data DEFINITION
  PUBLIC
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.
    INTERFACES if_oo_adt_classrun.
  PROTECTED SECTION.
  PRIVATE SECTION.
    METHODS fill_master_data.
    METHODS flush.
    METHODS fill_transaction_data.
ENDCLASS.



CLASS zats_00_fill_data IMPLEMENTATION.
    METHOD if_oo_adt_classrun~main.
        me->flush( ).
        me->fill_master_data( ).
        me->fill_transaction_data(  ).
        out->write( 'Execution completed, Watch out the data in tables' ).
    ENDMETHOD.

    METHOD fill_transaction_data.

        data : o_rand type REF TO cl_abap_random_int,
               n type i,
               seed type i,
               lv_date type timestamp,
               lv_ord_id type zats_00_de_id,
               lt_so type table of zats_00_so,
               lt_so_i type table of zats_00_so_i.

        seed = cl_abap_random=>seed( ).
        cl_abap_random_int=>create(
          EXPORTING
            seed = seed
            min  = 1
            max  = 7
          RECEIVING
            prng = o_rand
        ).
        get time stamp FIELD lv_date.

        select * from zats_00_bp into table @data(lt_bp).
        select * from zats_00_product into table @data(lt_prod).

        do 10 times.
            lv_ord_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32(  ).
            n = o_rand->get_next( ).
            read table lt_bp into data(ls_bp) INDEX n.
            append value #( order_id = lv_ord_id
                            order_no = sy-index
                            buyer = ls_bp-bp_id
                            gross_amount = n * 100
                            currency = 'INR'
                            created_by = sy-uname
                            created_on = lv_date
                            changed_by = sy-uname
                            changed_on = lv_date
                         )  to lt_so.
            do 2 times.
                read table lt_prod into data(ls_product) INDEX n.
                n = o_rand->get_next( ).
                append value #( order_id = lv_ord_id
                            item_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32(  )
                            product = ls_product-product_id
                            qty = n
                            uom = 'PC'
                            amount = n * ls_product-price
                            currency = 'INR'
                            created_by = sy-uname
                            created_on = lv_date
                            changed_by = sy-uname
                            changed_on = lv_date
                         )  to lt_so_i.
            ENDDO.
        ENDDO.

        insert zats_00_so from table @lt_so.
        insert zats_00_so_i from table @lt_so_i.

    ENDMETHOD.
    METHOD fill_master_data.

        data: lt_bp type TABLE of zats_00_bp,
              lt_prod type table of zats_00_product.

        append value #(
                    bp_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    bp_role = '01'
                    company_name = 'TACUM'
                    street = 'Victoria Street'
                    city = 'Kolkatta'
                    country = 'IN'
                    region = 'APJ'
                    )
                    to lt_bp.
    append value #(
                    bp_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    bp_role = '01'
                    company_name = 'SAP'
                    street = 'Rosvelt Street Road'
                    city = 'Walldorf'
                    country = 'DE'
                    region = 'EMEA'
                    )
                    to lt_bp.
    append value #(
                    bp_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    bp_role = '01'
                    company_name = 'Asia High tech'
                    street = '1-7-2 Otemachi'
                    city = 'Tokyo'
                    country = 'JP'
                    region = 'APJ'
                    )
                    to lt_bp.
    append value #(
                    bp_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    bp_role = '01'
                    company_name = 'AVANTEL'
                    street = 'Bosque de Duraznos'
                    city = 'Maxico'
                    country = 'MX'
                    region = 'NA'
                    )
                    to lt_bp.
    append value #(
                    bp_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    bp_role = '01'
                    company_name = 'Pear Computing Services'
                    street = 'Dunwoody Xing'
                    city = 'Atlanta, Georgia'
                    country = 'US'
                    region = 'NA'
                    )
                    to lt_bp.
    append value #(
                    bp_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    bp_role = '01'
                    company_name = 'PicoBit'
                    street = 'Fith Avenue'
                    city = 'New York City'
                    country = 'US'
                    region = 'NA'
                    )
                    to lt_bp.
    append value #(
                    bp_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    bp_role = '01'
                    company_name = 'TACUM'
                    street = 'Victoria Street'
                    city = 'Kolkatta'
                    country = 'IN'
                    region = 'APJ'
                    )
                    to lt_bp.
    append value #(
                    bp_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    bp_role = '01'
                    company_name = 'Indian IT Trading Company'
                    street = 'Nariman Point'
                    city = 'Mumbai'
                    country = 'IN'
                    region = 'APJ'
                    )
                    to lt_bp.

   append value #(
                    product_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    name = 'Blaster Extreme'
                    category = 'Speakers'
                    price = 175
                    currency = 'INR'
                    discount = 3
                    )
                    to lt_prod.
    append value #(
                    product_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    name = 'Sound Booster'
                    category = 'Speakers'
                    price = 250
                    currency = 'INR'
                    discount = 2
                    )
                    to lt_prod.
    append value #(
                    product_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    name = 'Smart Office'
                    category = 'Software'
                    price = 154
                    currency = 'INR'
                    discount = 32
                    )
                    to lt_prod.
    append value #(
                    product_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    name = 'Smart Design'
                    category = 'Software'
                    price = 240
                    currency = 'INR'
                    discount = 12
                    )
                    to lt_prod.
    append value #(
                    product_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    name = 'Transcend Carry pocket'
                    category = 'PCs'
                    price = 140
                    currency = 'INR'
                    discount = 7
                    )
                    to lt_prod.
    append value #(
                    product_id = cl_uuid_factory=>create_system_uuid( )->create_uuid_c32( )
                    name = 'Gaming Monster Pro'
                    category = 'PCs'
                    price = 155
                    currency = 'INR'
                    discount = 8
                    )
                    to lt_prod.

        INSERT zats_00_bp from table @lt_bp.
        INSERT zats_00_product from table @lt_prod.
    ENDMETHOD.
    METHOD flush.
        delete from: zats_00_bp, zats_00_product, zats_00_so, zats_00_so_i.
    ENDMETHOD.
ENDCLASS.
